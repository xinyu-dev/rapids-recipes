questions,labels
how many patients were diagnosed with respiratory acidosis - chronic and did not come to the hospital in the same month?,"select ( select count( distinct t1.uniquepid ) from ( select patient.uniquepid, diagnosis.diagnosistime from diagnosis join patient on diagnosis.patientunitstayid = patient.patientunitstayid where diagnosis.diagnosisname = 'respiratory acidosis - chronic' ) as t1 ) - ( select count( distinct t2.uniquepid ) from ( select patient.uniquepid, diagnosis.diagnosistime from diagnosis join patient on diagnosis.patientunitstayid = patient.patientunitstayid where diagnosis.diagnosisname = 'respiratory acidosis - chronic' ) as t2 join patient on t2.uniquepid = patient.uniquepid where t2.diagnosistime < patient.hospitaladmittime and datetime(t2.diagnosistime,'start of month') = datetime(patient.hospitaladmittime,'start of month') )"
what is the drug that patient 013-866 was prescribed for after being diagnosed with coronary artery disease - known during the same hospital encounter in 05/this year?,"select t2.drugname from ( select patient.uniquepid, diagnosis.diagnosistime, patient.patienthealthsystemstayid from diagnosis join patient on diagnosis.patientunitstayid = patient.patientunitstayid where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '013-866' ) and diagnosis.diagnosisname = 'coronary artery disease - known' and datetime(diagnosis.diagnosistime,'start of year') = datetime(current_time,'start of year','-0 year') and strftime('%m',diagnosis.diagnosistime) = '05' ) as t1 join ( select patient.uniquepid, medication.drugname, medication.drugstarttime, patient.patienthealthsystemstayid from medication join patient on medication.patientunitstayid = patient.patientunitstayid where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '013-866' ) and datetime(medication.drugstarttime,'start of year') = datetime(current_time,'start of year','-0 year') and strftime('%m',medication.drugstarttime) = '05' ) as t2 on t1.uniquepid = t2.uniquepid where t1.diagnosistime < t2.drugstarttime and t1.patienthealthsystemstayid = t2.patienthealthsystemstayid"
"what is the five most frequent drugs that were prescribed within 2 months to acute renal failure - etiology unknown female patients aged 30s after having been diagnosed with acute renal failure - etiology unknown, in 2103?","select t3.drugname from ( select t2.drugname, dense_rank() over ( order by count(*) desc ) as c1 from ( select patient.uniquepid, diagnosis.diagnosistime from diagnosis join patient on diagnosis.patientunitstayid = patient.patientunitstayid where diagnosis.diagnosisname = 'acute renal failure - etiology unknown' and strftime('%y',diagnosis.diagnosistime) = '2103' ) as t1 join ( select patient.uniquepid, medication.drugname, medication.drugstarttime from medication join patient on medication.patientunitstayid = patient.patientunitstayid where patient.gender = 'female' and patient.age between 30 and 39 and strftime('%y',medication.drugstarttime) = '2103' ) as t2 on t1.uniquepid = t2.uniquepid where t1.diagnosistime < t2.drugstarttime and datetime(t2.drugstarttime) between datetime(t1.diagnosistime) and datetime(t1.diagnosistime,'+2 month') group by t2.drugname ) as t3 where t3.c1 <= 5"
how many metoprolol succinate er 50 mg po tb24 prescription cases are there until 4 years ago?,"select count(*) from medication where medication.drugname = 'metoprolol succinate er 50 mg po tb24' and datetime(medication.drugstarttime) <= datetime(current_time,'-4 year')"
what are the top five frequently prescribed drugs that patients have been prescribed in the same hospital encounter after having been diagnosed with acute respiratory failure - due to neurological process until 3 years ago?,"select t3.drugname from ( select t2.drugname, dense_rank() over ( order by count(*) desc ) as c1 from ( select patient.uniquepid, diagnosis.diagnosistime, patient.patienthealthsystemstayid from diagnosis join patient on diagnosis.patientunitstayid = patient.patientunitstayid where diagnosis.diagnosisname = 'acute respiratory failure - due to neurological process' and datetime(diagnosis.diagnosistime) <= datetime(current_time,'-3 year') ) as t1 join ( select patient.uniquepid, medication.drugname, medication.drugstarttime, patient.patienthealthsystemstayid from medication join patient on medication.patientunitstayid = patient.patientunitstayid where datetime(medication.drugstarttime) <= datetime(current_time,'-3 year') ) as t2 on t1.uniquepid = t2.uniquepid where t1.diagnosistime < t2.drugstarttime and t1.patienthealthsystemstayid = t2.patienthealthsystemstayid group by t2.drugname ) as t3 where t3.c1 <= 5"
tell me patient 016-18150's maximum temperature on last month/03?,"select max(vitalperiodic.temperature) from vitalperiodic where vitalperiodic.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '016-18150' ) ) and vitalperiodic.temperature is not null and datetime(vitalperiodic.observationtime,'start of month') = datetime(current_time,'start of month','-1 month') and strftime('%d',vitalperiodic.observationtime) = '03'"
what procedure did patient 006-158338 receive the last time since 6 years ago.,"select treatment.treatmentname from treatment where treatment.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '006-158338' ) ) and datetime(treatment.treatmenttime) >= datetime(current_time,'-6 year') order by treatment.treatmenttime desc limit 1"
how many hours have passed since patient 010-16572's hospital admission?,"select 24 * ( strftime('%j',current_time) - strftime('%j',patient.hospitaladmittime) ) from patient where patient.uniquepid = '010-16572' and patient.hospitaldischargetime is null"
is patient 005-11182's level of heartrate last measured on the first icu visit greater than it was first measured on the first icu visit?,select ( select vitalperiodic.heartrate from vitalperiodic where vitalperiodic.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '005-11182' ) and patient.unitdischargetime is not null order by patient.unitadmittime asc limit 1 ) and vitalperiodic.heartrate is not null order by vitalperiodic.observationtime desc limit 1 ) > ( select vitalperiodic.heartrate from vitalperiodic where vitalperiodic.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '005-11182' ) and patient.unitdischargetime is not null order by patient.unitadmittime asc limit 1 ) and vitalperiodic.heartrate is not null order by vitalperiodic.observationtime asc limit 1 )
the systemicmean of patient 006-167444 second measured on the first intensive care unit visit was less than the first value measured on the first intensive care unit visit?,select ( select vitalperiodic.systemicmean from vitalperiodic where vitalperiodic.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '006-167444' ) and patient.unitdischargetime is not null order by patient.unitadmittime asc limit 1 ) and vitalperiodic.systemicmean is not null order by vitalperiodic.observationtime asc limit 1 offset 1 ) < ( select vitalperiodic.systemicmean from vitalperiodic where vitalperiodic.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '006-167444' ) and patient.unitdischargetime is not null order by patient.unitadmittime asc limit 1 ) and vitalperiodic.systemicmean is not null order by vitalperiodic.observationtime asc limit 1 )
does a microbiological test have been performed for patient 025-44495 since 10/2105?,"select count(*)>0 from microlab where microlab.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '025-44495' ) ) and strftime('%y-%m',microlab.culturetakentime) >= '2105-10'"
count the number of times in which patient 017-61209 had had a tube feeding flush (ml) intake on 06/10/last year.,"select count(*) from intakeoutput where intakeoutput.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '017-61209' ) ) and intakeoutput.cellpath like '%intake%' and intakeoutput.celllabel = 'tube feeding flush (ml)' and datetime(intakeoutput.intakeoutputtime,'start of year') = datetime(current_time,'start of year','-1 year') and strftime('%m-%d',intakeoutput.intakeoutputtime) = '06-10'"
what are the top four prescription drugs for the patients with age 20s this year?,"select t1.drugname from ( select medication.drugname, dense_rank() over ( order by count(*) desc ) as c1 from medication where medication.patientunitstayid in ( select patient.patientunitstayid from patient where patient.age between 20 and 29 ) and datetime(medication.drugstarttime,'start of year') = datetime(current_time,'start of year','-0 year') group by medication.drugname ) as t1 where t1.c1 <= 4"
count the number of patients who were admitted until 2102 to the hospital.,"select count( distinct patient.uniquepid ) from patient where strftime('%y',patient.hospitaladmittime) <= '2102'"
what were the five most frequently performed procedures for patients who received neurosurgery - drainage of hematoma-craniotomy previously in the same hospital visit until 3 years ago?,"select t3.treatmentname from ( select t2.treatmentname, dense_rank() over ( order by count(*) desc ) as c1 from ( select patient.uniquepid, treatment.treatmenttime, patient.patienthealthsystemstayid from treatment join patient on treatment.patientunitstayid = patient.patientunitstayid where treatment.treatmentname = 'neurosurgery - drainage of hematoma-craniotomy' and datetime(treatment.treatmenttime) <= datetime(current_time,'-3 year') ) as t1 join ( select patient.uniquepid, treatment.treatmentname, treatment.treatmenttime, patient.patienthealthsystemstayid from treatment join patient on treatment.patientunitstayid = patient.patientunitstayid where datetime(treatment.treatmenttime) <= datetime(current_time,'-3 year') ) as t2 on t1.uniquepid = t2.uniquepid where t1.treatmenttime < t2.treatmenttime and t1.patienthealthsystemstayid = t2.patienthealthsystemstayid group by t2.treatmentname ) as t3 where t3.c1 <= 5"
tell me the number of times patient 006-129568 had received a mode lab test since 5 years ago.,"select count(*) from lab where lab.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '006-129568' ) ) and lab.labname = 'mode' and datetime(lab.labresulttime) >= datetime(current_time,'-5 year')"
when until 2104 patient 013-33898 received a procedure for the last time?,"select treatment.treatmenttime from treatment where treatment.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '013-33898' ) ) and strftime('%y',treatment.treatmenttime) <= '2104' order by treatment.treatmenttime desc limit 1"
what are the drugs that patient 015-91239 is allergic to in their current hospital encounter?,select allergy.drugname from allergy where allergy.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '015-91239' and patient.hospitaldischargetime is null ) )
"is there any results of the urine, voided specimen microbiology test of patient 025-19271?","select count(*) from microlab where microlab.patientunitstayid in ( select patient.patientunitstayid from patient where patient.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.uniquepid = '025-19271' ) ) and microlab.culturesite = 'urine, voided specimen'"
what is the average hospital cost involving a drug that is called cefazolin 2 gm in ns 100 ml ivpb until 2103?,"select avg(t1.c1) from ( select sum(cost.cost) as c1 from cost where cost.patienthealthsystemstayid in ( select patient.patienthealthsystemstayid from patient where patient.patientunitstayid in ( select medication.patientunitstayid from medication where medication.drugname = 'cefazolin 2 gm in ns 100 ml ivpb' ) ) and strftime('%y',cost.chargetime) <= '2103' group by cost.patienthealthsystemstayid ) as t1"
